---

- name: Disable APT recommended packages
  template:
    src: recommends.j2
    dest: /etc/apt/apt.conf.d/60recommends

- name: Update Debian sources list
  apt_repository:
    repo: "{{ item }}"
    state: present
    filename: "debian"
  with_items:
    - "deb https://deb.debian.org/debian/ {{ ansible_lsb.codename }} main contrib non-free"
    - "deb-src https://deb.debian.org/debian/ {{ ansible_lsb.codename }} main contrib non-free"
    - "deb https://deb.debian.org/debian/ {{ ansible_lsb.codename }}-updates main contrib non-free"
    - "deb-src https://deb.debian.org/debian/ {{ ansible_lsb.codename }}-updates main contrib non-free"
    - "deb https://deb.debian.org/debian-security/ {{ ansible_lsb.codename }}-security main contrib non-free"
    - "deb-src https://deb.debian.org/debian-security/ {{ ansible_lsb.codename }}-security main contrib non-free"
    - "deb https://deb.debian.org/debian {{ ansible_lsb.codename }}-backports main contrib non-free"
  when: ansible_distribution == 'Debian'
