---
lemonldap_ldap_group_base: "{{ openldap.ldap.structure_groups_ou_dns['sso_groups'] }}"

lemonldap_location_rules:
  #- domain: "*.[something].{{ web_base_domain }}"
  #  default_rule: groupMatch($hGroups, 'cn', 'group_name')
  #  # To require TOTP, set the level to >= 4
  #  #requiredAuthnLevel: 4

  - domain: "*.infra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'infra')
  - domain: "*.infra.intra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'infra')
  - domain: "*.auth.intra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'infra')

  - domain: "*.log.intra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'infra')
  - domain: "*.monitoring.intra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'infra')

  - domain: "*.dev.intra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'dev')
  # Skip gitea to enable https repo operations
  - domain: "gitea.dev.intra.{{ web_base_domain }}"
    default_rule: skip

  - domain: "*.dl.intra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'dl')

  - domain: "*.home.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'home')
  - domain: "*.home.intra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'home')
  - domain: "homeassistant.home.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'home')
    rules:
      # Disable Auth for HomeAssistant API
      - name: 00-HomeAssistant_API
        uri: ^/api/
        rule: skip
      # Disable Auth for HomeAssistant OAuth
      - name: 00-HomeAssistant_OAuth
        uri: ^/auth/token
        rule: skip

  - domain: "*.stream.intra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'stream')
  # Skip jellyfin to enable streming in the LAN
  - domain: "jellyfin.stream.intra.{{ web_base_domain }}"
    default_rule: skip

  - domain: "*.web.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'web')
  # Disable Auth for Gotify
  - domain: "gotify.web.{{ web_base_domain }}"
    default_rule: skip

  - domain: "*.tool.intra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'tool')
  - domain: "syncthing.tool.intra.{{ web_base_domain }}"
    default_rule: groupMatch($hGroups, 'cn', 'syncthing')
