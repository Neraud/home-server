apiVersion: v1
kind: Secret
metadata:
  name: alertmanager-main
  namespace: monitoring
  labels:
    app: alertmanager
    app-component: alertmanager
type: Opaque
data:
{% for alertmanager_config_file in alertmanager_config_files %}
  {{ alertmanager_config_file | basename | replace(".j2", "") }}: {{ lookup(alertmanager_config_file | regex_search('.j2$') | ternary('template','file'), alertmanager_config_file) | b64encode }}
{% endfor %}