apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: cluster-kubernetes-replicator
  namespace: dev-argo-cd
  # Add this finalizer ONLY if you want these to cascade delete.
  finalizers:
    - resources-finalizer.argocd.argoproj.io
  labels:
    app.kubernetes.io/name: reflector
spec:
  project: k8s-cluster

  source:
    repoURL: http://gitea.dev-gitea.svc.cluster.local:3000/MyOrg/home-server.git
    targetRevision: dev/gitops
    path: apps/vagrant/cluster-kubernetes-replicator/deploy
  
  destination:
    server: https://kubernetes.default.svc
    namespace: cluster-kubernetes-replicator

  syncPolicy:
    syncOptions:
    - PruneLast=true # Allow the ability for resource pruning to happen as a final, implicit wave of a sync operation
